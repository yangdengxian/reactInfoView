'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.createReactRouterResponse = undefined;

var _reactRouter = require('react-router');

var _createTemplateString = require('../utils/createTemplateString');

var createReactRouterResponse = exports.createReactRouterResponse = function createReactRouterResponse(routes) {
    return function (Template, templatePropsProvider) {
        return function (req, res) {

            (0, _reactRouter.match)({ routes: routes, location: req.url }, function (error, redirectLocation, renderProps) {
                if (redirectLocation) {
                    res.status(301).redirect(redirectLocation.pathname + redirectLocation.search);
                } else if (error) {
                    res.status(500).send(error.message);
                } else if (renderProps === null) {
                    res.status(404).send('Not found');
                } else {
                    var templateProps = templatePropsProvider(renderProps, req, res);
                    res.status(200).send((0, _createTemplateString.createTemplateString)(templateProps, Template));
                }
            });
        };
    };
};